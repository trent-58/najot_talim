{% extends 'base.html' %}
{% block title %}User: {{ object.username }}{% endblock %}
{% block content %}
  <h1>{{ object.username }}</h1>
  <div class="row">
    <div class="col-md-4">
      <div class="profile-card">
        <h4>{{ object.username }}</h4>
        <p class="mb-1">Email: {{ object.email }}</p>
        <p class="mb-1">Joined: {{ object.date_joined|date:"Y-m-d" }}</p>
        {% if request.user.is_authenticated and request.user == object %}
          <p class="mt-2">
            <a class="btn btn-secondary btn-sm" href="{% url 'users:user_edit' object.pk %}">Edit profile</a>
            <a class="btn btn-danger btn-sm" href="{% url 'users:user_delete' object.pk %}">Delete account</a>
            <a class="btn btn-info btn-sm" href="{% url 'users:password_change' %}">Change password</a>
          </p>
        {% endif %}
      </div>
    </div>
    <div class="col-md-8">
      <p class="mb-2"><strong>About</strong></p>
      <p class="text-muted">No bio yet.</p>
    </div>
  </div>
  {% if request.user.is_authenticated and request.user == object %}
    <p>
      <a class="btn btn-secondary" href="{% url 'users:user_edit' object.pk %}">Edit profile</a>
      <a class="btn btn-danger" href="{% url 'users:user_delete' object.pk %}">Delete account</a>
      <a class="btn btn-info" href="{% url 'users:password_change' %}">Change password</a>
    </p>
  {% endif %}

  <h3 class="mt-4">Products by {{ object.username }}</h3>
  <ul>
    {% for p in products %}
      <li><a href="{{ p.get_absolute_url }}">{{ p.title }}</a></li>
    {% empty %}
      <li>No products.</li>
    {% endfor %}
  </ul>
  <h3 class="mt-4">Comments by {{ object.username }}</h3>
  <div class="list-group">
    {% for c in comments %}
      <div class="list-group-item">
        <div class="d-flex w-100 justify-content-between">
          <h6 class="mb-1"><a href="{{ c.product.get_absolute_url }}">{{ c.product.title }}</a></h6>
          {% if c.rating %}<small class="text-muted">Rating: {{ c.rating }}</small>{% endif %}
        </div>
        <p class="mb-1 text-muted">{{ c.text|truncatechars:120 }}</p>
      </div>
    {% empty %}
      <div class="list-group-item">No comments.</div>
    {% endfor %}
  </div>
{% endblock %}
