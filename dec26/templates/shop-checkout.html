{% extends 'base.html' %}
{% load static %}
{% block content %}
  <main class="main-content">
    <!--== Start Product Area Wrapper ==-->
    <section class="product-area product-information-area">
      <div class="container">
        <div class="product-information">
          <div class="row">
            <div class="col-lg-7">
              <div class="edit-checkout-head">
                <div class="header-logo-area">
                  <a href="{% url 'shop:home' %}">
                    <img class="logo-main" src="{% static 'assets/img/logo.png' %}" alt="Logo">
                    <img class="logo-light" src="{% static 'assets/img/logo.png' %}" alt="Logo">
                  </a>
                </div>
                <div class="breadcrumb-area">
                  <ul>
                    <li><a href="{% url 'cart:view' %}">Cart</a><i class="fa fa-angle-right"></i></li>
                    <li class="active">Information<i class="fa fa-angle-right"></i></li>
                    <li>Shipping<i class="fa fa-angle-right"></i></li>
                    <li>Payment</li>
                  </ul>
                </div>
              </div>

              {% if messages %}
                {% for message in messages %}
                  <div class="alert alert-{{ message.tags }}" style="margin: 20px 0; padding: 15px; border-radius: 5px;">
                    {{ message }}
                  </div>
                {% endfor %}
              {% endif %}

              <div class="edit-checkout-information">
                <h4 class="title">Contact information</h4>

                <form method="post" action="{% url 'cart:process_checkout' %}">
                  {% csrf_token %}

                  <div class="form-floating" style="margin-bottom: 20px;">
                    <input type="email" class="form-control" id="email" name="email" placeholder="Email"
                           value="{% if user.is_authenticated %}{{ user.email }}{% endif %}" required>
                    <label for="email">Email</label>
                  </div>

                  <div class="form-check form-check-inline" style="margin-bottom: 20px;">
                    <input class="form-check-input" type="checkbox" id="newsletter" name="newsletter" value="yes">
                    <label class="form-check-label" for="newsletter">Keep me up to date on news and exclusive offers</label>
                  </div>

                  <div class="edit-checkout-form">
                    <h4 class="title">Shipping address</h4>
                    <div class="row row-gutter-12">
                      <div class="col-lg-6">
                        <div class="form-floating">
                          <input type="text" class="form-control" id="first_name" name="first_name" placeholder="First name"
                                 value="{% if user.is_authenticated and user.profile %}{{ user.profile.first_name }}{% endif %}">
                          <label for="first_name">First name (optional)</label>
                        </div>
                      </div>
                      <div class="col-lg-6">
                        <div class="form-floating">
                          <input type="text" class="form-control" id="last_name" name="last_name" placeholder="Last name"
                                 value="{% if user.is_authenticated and user.profile %}{{ user.profile.last_name }}{% endif %}" required>
                          <label for="last_name">Last name *</label>
                        </div>
                      </div>
                      <div class="col-lg-12">
                        <div class="form-floating">
                          <input type="text" class="form-control" id="address" name="address" placeholder="Address" required>
                          <label for="address">Address *</label>
                        </div>
                      </div>
                      <div class="col-lg-12">
                        <div class="form-floating">
                          <input type="text" class="form-control" id="apartment" name="apartment" placeholder="Apartment">
                          <label for="apartment">Apartment, suite, etc. (optional)</label>
                        </div>
                      </div>
                      <div class="col-lg-12">
                        <div class="form-floating">
                          <input type="text" class="form-control" id="city" name="city" placeholder="City" required>
                          <label for="city">City *</label>
                        </div>
                      </div>
                      <div class="col-lg-6">
                        <div class="form-floating">
                          <select class="form-select form-control" id="country" name="country" required>
                            <option value="United States" selected>United States</option>
                            <option value="United Kingdom">United Kingdom</option>
                            <option value="Canada">Canada</option>
                            <option value="Australia">Australia</option>
                            <option value="Germany">Germany</option>
                            <option value="France">France</option>
                            <option value="Spain">Spain</option>
                            <option value="Italy">Italy</option>
                            <option value="Japan">Japan</option>
                            <option value="China">China</option>
                            <option value="India">India</option>
                            <option value="Brazil">Brazil</option>
                            <option value="Mexico">Mexico</option>
                            <option value="Other">Other</option>
                          </select>
                          <div class="field-caret"></div>
                          <label for="country">Country/Region *</label>
                        </div>
                      </div>
                      <div class="col-lg-6">
                        <div class="form-floating">
                          <input type="text" class="form-control" id="postal_code" name="postal_code" placeholder="Postal code" required>
                          <label for="postal_code">Postal code *</label>
                        </div>
                      </div>
                      <div class="col-12">
                        <div class="btn-box">
                          <a class="btn-return" href="{% url 'cart:view' %}">
                            <svg focusable="false" aria-hidden="true" class="icon-svg icon-svg--color-accent icon-svg--size-10 previous-link__icon" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 10">
                              <path d="M8 1L7 0 3 4 2 5l1 1 4 4 1-1-4-4"></path>
                            </svg>
                            Return to cart
                          </a>
                          <button type="submit" class="btn-shipping">Continue to shipping</button>
                        </div>
                      </div>
                    </div>
                  </div>
                </form>
              </div>
            </div>
            <div class="col-lg-5">
              <div class="shipping-cart-subtotal-wrapper">
                <div class="shipping-cart-subtotal">
                  {% for item in cart.items.all %}
                  <div class="shipping-cart-item">
                    <div class="thumb">
                      {% if item.product.get_primary_image %}
                        <img src="{{ item.product.get_primary_image.image.url }}" alt="{{ item.product.name }}">
                      {% else %}
                        <img src="{% static 'assets/img/shop/default.webp' %}" alt="{{ item.product.name }}">
                      {% endif %}
                      <span class="quantity">{{ item.quantity }}</span>
                    </div>
                    <div class="content">
                      <h4 class="title">{{ item.product.name }}</h4>
                      <span class="info">{{ item.product.sku|default:"" }}</span>
                      <span class="price">
                        {% if item.product.discount_price %}
                          ${{ item.product.discount_price }}
                        {% else %}
                          ${{ item.product.price }}
                        {% endif %}
                      </span>
                    </div>
                  </div>
                  {% endfor %}

                  <div class="shipping-subtotal">
                    <p><span>Subtotal</span><span><strong>${{ cart.get_total }}</strong></span></p>
                    <p><span>Shipping</span><span>$10.00</span></p>
                  </div>
                  <div class="shipping-total">
                    <p class="total">Total</p>
                    <p class="price"><span class="usd">USD</span>${{ cart.get_total|add:10 }}</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <!--== End Product Area Wrapper ==-->
    <div class="edit-checkout-footer">
      <p>All rights reserved &copy; {{ request.get_host }}</p>
    </div>
  </main>
{% endblock content %}

